<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Quadrotor Gamepad Controller</title>
    <style>
        #gamepad-status {
            padding: 8px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-weight: bold;
        }
        .gamepad-connected {
            background-color: #d4edda;
            color: #155724;
        }
        .gamepad-disconnected {
            background-color: #f8d7da;
            color: #721c24;
        }
        #gamepad-state{
            display: table;
            border-spacing: 1rem;
            border-collapse: separate;
        }
        .gamepad-controls-row {
            display: table-row;
            margin-bottom: 5px;
        }
        .gamepad-controls-cell {
            display: table-cell;
            margin: 10px;
            vertical-align: middle;
            margin-bottom: 5px;
        }
        .gamepad-slider-container {
            position: relative;
            height: 30px;
        }
        .gamepad-slider {
            width: 100px;
            height: 10px;
            pointer-events: none;
        }
        .gamepad-button-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #ccc;
        }
        #gamepad-button-container {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .gamepad-button {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        .gamepad-button:hover {
            background-color: #0069d9;
        }
        .gamepad-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .gamepad-value-display, .gamepad-raw-value-display {
            text-align: right;
            font-family: monospace;
        }
        .gamepad-raw-value-display {
            color: #555; /* Slightly muted to distinguish from processed value */
        }
        .gamepad-mapping-button {
        }
        .gamepad-main-button {
            grid-column: span 2;
        }
        .gamepad-reset-button{
            background-color: #cb2c2c;
        }
        .gamepad-reset-button:hover {
            background-color: #942121;
        }
        .gamepad-separator {
            height: 1px;
            background-color: #ddd;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <template id="gamepad-axis-template">
        <div class="gamepad-controls-row">
            <div class="gamepad-controls-name gamepad-controls-cell"></div>
            <div class="gamepad-slider-container gamepad-controls-cell"><input type="range" class="gamepad-slider" min="-1" max="1" value="0" step="0.01" disabled></div>
            <div class="gamepad-value-display gamepad-controls-cell">0.00</div>
        </div>
    </template>
    <template id="gamepad-button-template">
        <div class="gamepad-controls-row">
            <div class="gamepad-controls-name gamepad-controls-cell"></div>
            <div class="gamepad-controls-cell"><div class="gamepad-button-indicator"></div></div>
            <div class="gamepad-value-display gamepad-controls-cell">Released</div>
            <div></div>
        </div>
    </template>
    <template id="gamepad-template">
        <div id="gamepad-status" class="gamepad-disconnected">No gamepad connected</div>
        <div id="gamepad-state">

        </div>
        <div id="gamepad-button-container">
        </div>
    </template>
    <h1>Quadrotor Gamepad Controller</h1>
    <script type="module">
        import { Gamepad } from "./gamepad.js";
        function init() {
            const gamepad = new Gamepad(document.body, {
                "thrust": {
                    type: "axis",
                    positive_direction: "Up"
                },
                "roll": {
                    type: "axis",
                    positive_direction: "Right"
                },
                "pitch": {
                    type: "axis",
                    positive_direction: "Forward"
                },
                "yaw": {
                    type: "axis",
                    positive_direction: "Clockwise"
                },
                "reset": {
                    type: "button"
                },
            })
            const saved = null; //localStorage.getItem('quadrotorGamepadMap');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    Object.assign(controlMap, parsed);
                } catch (e) {}
            }
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
